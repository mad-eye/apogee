<?xml version="1.0" encoding="UTF-8"?>
        <!-- Copyright 2012 Google Inc. All Rights Reserved -->
    	<Module>
    	  <ModulePrefs title="Face Movement">
    	  <Require feature="rpc"/>
          <Require feature="views" />
    	</ModulePrefs>
    	<Content type="html"><![CDATA[
<!DOCTYPE html>

<script src="https://talkgadget.google.com/hangouts/_/api/hangout.js?v=1.2" ></script>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>

<div style="width:100%; height:100%">
<iframe id="theIFrame" frameborder="no" scrolling="yes" src="" style="width:100%; height:100%"></iframe>
</div>

<script>var appData = gadgets.views.getParams()['appData'];
var projectUrl = appData;
var theIFrame = document.getElementById("theIFrame");
if (appData){
    gapi.hangout.data.setValue("projectUrl", appData);
    theIFrame.src = appData;
}
//this feels a bit hacky..i hope there's a better way to know when state object is ready
else {
    var intervalId = setInterval(function(){
        var state = gapi.hangout.data.getState();
        if (state){
            clearInterval(intervalId);
            projectUrl = state.projectUrl
            theIFrame.src = projectUrl;
        }
    }, 200);
}
</script>
<script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
<br/>
]]></Content></Module>
