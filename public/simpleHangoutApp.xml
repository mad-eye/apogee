<?xml version="1.0" encoding="UTF-8"?>
        <!-- Copyright 2012 Google Inc. All Rights Reserved -->
        <Module>
    	  <ModulePrefs title="Face Movement">
    	  <Require feature="rpc"/>
          <Require feature="views" />
    	</ModulePrefs>
    	<Content type="html"><![CDATA[
<!DOCTYPE html>

<script src="https://talkgadget.google.com/hangouts/_/api/hangout.js?v=1.2" ></script>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>
<script>
$(document).ready(function(){
$("body").css("height", "100%");
$("html").css("height", "100%");
});
</script>
<div style="height:100%">
<iframe id="theIFrame" frameborder="no" scrolling="yes" src="" style="width:100%; height:100%"></iframe>
</div>

<script>var appData = gadgets.views.getParams()['appData'];
var projectUrl = appData;
var theIFrame = document.getElementById("theIFrame");
if (appData){
    gapi.hangout.data.setValue("projectUrl", appData);
    theIFrame.src = appData + "?hangout=true";
}
//this feels a bit hacky..i hope there's a better way to know when state object is ready
else {
    var intervalId = setInterval(function(){
        var state = gapi.hangout.data.getState();
        if (state){
            clearInterval(intervalId);
            if (state.projectUrl){
                projectUrl = state.projectUrl
                theIFrame.src = projectUrl + "?hangout=true";
            }
            else {
                theIFrame.src = "http://madeye.io/missing-project";
            }
        }
    }, 200);
}
</script>
<br/>
]]></Content></Module>
